# Phase 5 의사결정 가이드

**작성일:** 2025-10-24
**목적:** 열린 이슈 3가지에 대한 구체적 의견 및 선택지 제공

---

## 🎯 빠른 결정 요약 (TL;DR)

비개발자분을 위한 간단 요약:

| 이슈 | 추천 선택 | 이유 |
|------|-----------|------|
| **1. 개발 일정** | MVP 5.1만 먼저 (약 50시간) | 빠르게 출시 → 피드백 → 개선 |
| **2. 멘토 권한** | 읽기 + 칭찬 코멘트만 | 자기주도성 유지하면서 격려 가능 |
| **3. 감정 데이터** | 30일 후 자동 익명화 | 개인정보 보호 + 패턴 분석 가능 |

**바로 시작하려면:** 위 3가지만 승인해주시면 즉시 구현 시작합니다!

---

## 📊 이슈 1: MVP 일정 및 공수 확정

### 현재 상황

| 출처 | 예상 시간 | 범위 |
|------|-----------|------|
| 제 설계 (Claude) | 78~104시간 | MVP 5.1 + 5.2 전체 |
| Grok/GPT/Gemini | 212~128시간 | 테스트 포함 전체 |

**차이 발생 이유:**
- 제 설계: 기존 코드베이스 재활용, 최소 기능만
- Grok: 테스트, 문서화, 예외처리 포함 보수적 추정

### 제 추천: **단계별 접근 (MVP 5.1 → 5.2 → 5.3)**

#### Option A: MVP 5.1만 먼저 (추천 ⭐⭐⭐)

**포함 기능:**
1. ✅ 나이대 선택 & 생일 자동 전환
2. ✅ 학습 모드 토글
3. ✅ 목표 설정 (기본만)
4. ✅ 만다라트 기본 (9칸)
5. ✅ 약점 관리 (메모 + 재시도)
6. ✅ 보상 시스템 (배지 기본)
7. ✅ 부모-자녀 공유 (읽기 전용)

**예상 시간:** 44~58시간 (약 6~7일 작업)

**장점:**
- 빠른 출시 (1~2주)
- 실제 사용자 피드백 수집
- 방향 조정 가능
- 리스크 최소화

**단점:**
- 고급 기능 없음 (81칸 만다라트, 감정 분석, 시간 최적화)

---

#### Option B: MVP 5.1 + 5.2 전체 (78~104시간)

**포함 기능:**
- 5.1 전체 + 만다라트 확장 (81칸) + 감정 기록 + 시간 최적화 + ICE 점수

**예상 시간:** 78~104시간 (약 10~13일 작업)

**장점:**
- 완전한 기능 세트
- 재작업 최소화

**단점:**
- 출시 지연
- 사용자 피드백 반영 어려움
- 사용되지 않는 기능 개발 가능성

---

#### Option C: Grok 방식 (212~128시간)

**포함 기능:**
- 5.1 + 5.2 + 자동화 테스트 + 상세 문서 + 예외처리 완벽

**예상 시간:** 128~212시간 (약 16~26일 작업)

**장점:**
- 완벽한 품질
- 유지보수 용이

**단점:**
- 너무 오래 걸림
- 스타트업 환경에 부적합

---

### 제 최종 추천: **Option A (MVP 5.1만 먼저)**

**이유:**
1. **린 스타트업 방식:** 빠르게 출시 → 측정 → 학습
2. **사용자 중심:** 실제 피드백으로 방향 조정
3. **리스크 관리:** 작은 단위로 검증
4. **동기 부여:** 빠른 성과로 팀 사기 진작

**실행 계획:**
```
Week 1: Step 1~3 (나이대, 토글, 목표)
Week 2: Step 4~5 (만다라트, 약점)
Week 3: Step 6~7 (보상, 부모 공유) + 테스트
Week 4: 사용자 테스트 & 피드백 수집
Week 5~: MVP 5.2 개발 시작 (필요시)
```

---

## 🔐 이슈 2: 멘토 역할 범위

### 현재 설계

`parent_child_sharing` 테이블:
- `can_view_goals` (목표 읽기)
- `can_view_weaknesses` (약점 읽기)
- `can_view_mandala` (만다라트 읽기)
- `can_send_praise` (칭찬 전송)

### 옵션 비교

#### Option A: 읽기 전용만

**권한:**
- ✅ 목표, 약점, 만다라트 **조회만**
- ❌ 코멘트 불가
- ❌ 수정 불가

**장점:**
- 자녀의 자기주도성 100% 보장
- 간단한 구현

**단점:**
- 부모가 격려하기 어려움
- 일방적 관찰만 가능

---

#### Option B: 읽기 + 칭찬 코멘트 (추천 ⭐⭐⭐)

**권한:**
- ✅ 조회
- ✅ `praise_messages` 전송 (칭찬, 격려)
- ❌ 목표/약점 직접 수정 불가

**칭찬 템플릿 예시:**
```
📍 목표 달성 시:
- "와! 목표를 달성했구나! 정말 자랑스러워!"
- "노력한 만큼 결과가 나왔네! 수고했어!"

📍 약점 기록 시:
- "어려운 점을 솔직하게 적었구나. 용감해!"
- "다음엔 더 잘할 수 있을 거야! 파이팅!"

📍 재시도 성공 시:
- "포기하지 않고 다시 도전해서 성공했구나! 멋져!"
```

**장점:**
- 정서적 지지 제공
- 자기주도성 유지 (직접 수정은 안 됨)
- 부모-자녀 소통 강화
- 회복탄력성 코칭 (실패 후 격려)

**단점:**
- 코멘트 시스템 추가 개발 필요 (약 4~6시간)

---

#### Option C: 읽기 + 코멘트 + 목표 제안

**권한:**
- ✅ 조회
- ✅ 코멘트
- ✅ 목표 제안 (자녀가 승인/거부)

**장점:**
- 부모가 적극적 역할
- 목표 설정 도움

**단점:**
- 자기주도성 저해 가능
- 부모-자녀 갈등 우려
- 복잡한 승인 워크플로우

---

### 제 최종 추천: **Option B (읽기 + 칭찬 코멘트)**

**이유:**
1. **교육 상담 원칙:** 칭찬과 격려는 동기 부여에 필수
2. **회복탄력성:** 실패 후 부모의 격려가 재도전 의지 강화
3. **균형:** 자기주도성 유지 + 정서적 지지
4. **실용성:** 템플릿으로 쉽게 사용 가능

**구현 예시:**
```jsx
// 부모 뷰: 자녀 목표 페이지
<Card>
  <h3>🎯 이번 주 목표: 수학 문제 30개 풀기</h3>
  <Progress value={70} />
  <p>21개 완료 (70%)</p>

  <Button onClick={() => sendPraise('goal_progress')}>
    💬 칭찬하기
  </Button>
</Card>

// 칭찬 템플릿 모달
<Select>
  <option>와! 70%나 달성했구나! 수고했어!</option>
  <option>정말 열심히 하고 있구나! 자랑스러워!</option>
  <option>조금만 더 힘내면 목표 달성이야! 파이팅!</option>
  <option>직접 입력...</option>
</Select>
```

---

## 🔒 이슈 3: 감정 데이터 보호 정책

### 법적 근거: PIPA (개인정보 보호법)

**아동 민감정보:**
- 감정 데이터는 **민감정보**에 해당 가능
- 부모라도 무조건 열람 불가
- 아동 본인의 삭제 요청권 보장

### 옵션 비교

#### Option A: 30일 후 자동 익명화 (추천 ⭐⭐⭐)

**동작:**
1. 감정 데이터 저장 (30일)
2. 30일 후 자동으로 `[익명화됨]`으로 변환
3. 부모는 "최근 감정 패턴" 요약만 확인
4. 아동이 원하면 즉시 삭제 가능

**예시:**
```sql
-- 30일 전 데이터
{
  "emotion_note": "분수 나눗셈이 너무 어려워서 짜증났어요",
  "emotion_type": "frustrated"
}

-- 30일 후 (자동 익명화)
{
  "emotion_note": "[익명화됨]",
  "emotion_type": null
}

-- 부모가 보는 요약
{
  "recent_emotions": {
    "frustrated": 3,  // 최근 좌절 3회
    "confident": 2,   // 최근 자신감 2회
    "trend": "개선 중"
  }
}
```

**장점:**
- PIPA 준수
- 단기 패턴 분석 가능
- 아동 프라이버시 보호

**단점:**
- 장기 데이터 소실

---

#### Option B: 60일 후 완전 삭제

**동작:**
- 60일 후 데이터베이스에서 완전 삭제

**장점:**
- 철저한 개인정보 보호

**단점:**
- 패턴 분석 불가
- 복구 불가

---

#### Option C: 영구 보관 (부모 접근 차단)

**동작:**
- 감정 데이터 영구 저장
- 부모는 절대 볼 수 없음
- 아동만 확인 가능

**장점:**
- 장기 자기 성찰 자료

**단점:**
- 저장 공간 증가
- PIPA 위반 가능성

---

### 제 최종 추천: **Option A (30일 후 자동 익명화)**

**이유:**
1. **법적 안전성:** PIPA 준수
2. **교육적 가치:** 단기 패턴 분석으로 자기 인식 향상
3. **프라이버시:** 아동 보호
4. **부모 참여:** 요약 정보로 적절한 지지 가능

**구현 세부사항:**

```sql
-- 1. 자동 익명화 함수
CREATE OR REPLACE FUNCTION anonymize_old_emotions()
RETURNS void AS $$
BEGIN
  UPDATE weaknesses
  SET
    emotion_note = '[익명화됨]',
    emotion_type = NULL
  WHERE
    created_at < NOW() - INTERVAL '30 days'
    AND emotion_note IS NOT NULL;
END;
$$ LANGUAGE plpgsql;

-- 2. 매일 자정 실행 (Supabase Cron)
SELECT cron.schedule(
  'anonymize-emotions-daily',
  '0 0 * * *',  -- 매일 00:00
  'SELECT anonymize_old_emotions();'
);

-- 3. 아동의 즉시 삭제 요청
CREATE OR REPLACE FUNCTION delete_my_emotions(p_weakness_id UUID)
RETURNS void AS $$
BEGIN
  UPDATE weaknesses
  SET
    emotion_note = NULL,
    emotion_type = NULL
  WHERE
    id = p_weakness_id
    AND child_id IN (SELECT id FROM children WHERE user_id = auth.uid());
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
```

**부모 뷰 (요약만):**
```jsx
// 부모가 보는 화면
<Card>
  <h3>📊 최근 감정 패턴 (지난 7일)</h3>
  <BarChart data={[
    { emotion: '자신감', count: 5 },
    { emotion: '흥미', count: 3 },
    { emotion: '좌절', count: 2 },
    { emotion: '불안', count: 1 }
  ]} />
  <p className="text-sm text-gray-500">
    * 구체적 내용은 자녀만 확인할 수 있습니다.
  </p>
</Card>
```

---

## 📋 의사결정 체크리스트

아래 체크박스에 ✅ 표시해주시면 바로 구현 시작하겠습니다!

### 이슈 1: 개발 일정
- [ ] **Option A:** MVP 5.1만 먼저 (44~58시간, 약 6~7일) ⭐ 추천
- [ ] **Option B:** MVP 5.1 + 5.2 전체 (78~104시간, 약 10~13일)
- [ ] **Option C:** Grok 방식 (128~212시간, 약 16~26일)

### 이슈 2: 멘토 역할
- [ ] **Option A:** 읽기 전용만
- [ ] **Option B:** 읽기 + 칭찬 코멘트 ⭐ 추천
- [ ] **Option C:** 읽기 + 코멘트 + 목표 제안

### 이슈 3: 감정 데이터
- [ ] **Option A:** 30일 후 자동 익명화 ⭐ 추천
- [ ] **Option B:** 60일 후 완전 삭제
- [ ] **Option C:** 영구 보관 (부모 접근 차단)

---

## 🎯 빠른 시작 패키지 (추천 조합)

**바쁘신 분을 위한 원클릭 선택:**

```
✅ MVP 5.1만 먼저 (6~7일)
✅ 읽기 + 칭찬 코멘트
✅ 30일 후 자동 익명화

→ 이 조합으로 바로 시작하시겠습니까?
```

**이 조합의 장점:**
1. 빠른 출시 (1~2주 내)
2. 교육적으로 검증된 접근
3. 법적 안전성 확보
4. 점진적 개선 가능
5. 사용자 피드백 빠른 반영

---

## 💬 추가 질문이 있다면?

1. **"MVP 5.1에 만다라트 확장 (81칸)도 포함되나요?"**
   - 아니요, 5.1은 기본 9칸만입니다.
   - 81칸은 MVP 5.2에 포함됩니다.
   - 사용자 피드백 후 필요시 추가합니다.

2. **"칭찬 코멘트는 자녀에게 어떻게 보이나요?"**
   - 앱 내 알림 (🔔)
   - 목표 페이지에 부모 코멘트 섹션
   - 읽음/안 읽음 표시

3. **"감정 데이터 30일은 너무 짧지 않나요?"**
   - 교육 전문가 권장: 2~4주가 패턴 분석 최적 기간
   - 너무 오래되면 현재 상태와 무관
   - 필요시 60일로 조정 가능

4. **"개발 일정 6~7일은 연속인가요?"**
   - 실제 작업 시간 기준 (50시간)
   - 하루 8시간 작업 시 약 6~7일
   - 파트타임이면 더 오래 걸릴 수 있음

---

**최종 수정일:** 2025-10-24
**문서 버전:** 1.0
**다음 단계:** 사용자 결정 → 마이그레이션 스크립트 작성 → 구현 시작
